<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Storage Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        button { padding: 10px 20px; margin: 5px; }
        .result { margin-top: 10px; padding: 10px; background: #f0f0f0; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Storage Test</h1>
    
    <div class="test-section">
        <h2>1. Test LocalStorage ì§ì ‘ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testDirectStorage()">ì§ì ‘ ì €ì¥ í…ŒìŠ¤íŠ¸</button>
        <button onclick="checkDirectStorage()">ì§ì ‘ ì½ê¸° í…ŒìŠ¤íŠ¸</button>
        <div id="directResult" class="result"></div>
    </div>

    <div class="test-section">
        <h2>2. Storage ëª¨ë“ˆ í…ŒìŠ¤íŠ¸</h2>
        <input type="text" id="testApiKey" placeholder="Gemini API Key ì…ë ¥" style="width: 400px; padding: 8px;">
        <br><br>
        <button onclick="testStorageModule()">Storage ëª¨ë“ˆë¡œ ì €ì¥</button>
        <button onclick="loadStorageModule()">Storage ëª¨ë“ˆë¡œ ì½ê¸°</button>
        <div id="moduleResult" class="result"></div>
    </div>

    <div class="test-section">
        <h2>3. ì „ì²´ ì„¤ì • í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testFullSettings()">ì „ì²´ ì„¤ì • ì €ì¥</button>
        <button onclick="loadFullSettings()">ì „ì²´ ì„¤ì • ì½ê¸°</button>
        <button onclick="clearAllSettings()">ì „ì²´ ì„¤ì • ì‚­ì œ</button>
        <div id="fullResult" class="result"></div>
    </div>

    <script src="js/storage.js"></script>
    <script>
        function testDirectStorage() {
            const result = document.getElementById('directResult');
            try {
                localStorage.setItem('test_key', 'test_value');
                result.innerHTML = '<span class="success">âœ… ì§ì ‘ ì €ì¥ ì„±ê³µ!</span>';
            } catch (e) {
                result.innerHTML = '<span class="error">âŒ ì˜¤ë¥˜: ' + e.message + '</span>';
            }
        }

        function checkDirectStorage() {
            const result = document.getElementById('directResult');
            const value = localStorage.getItem('test_key');
            if (value) {
                result.innerHTML = '<span class="success">âœ… ì½ê¸° ì„±ê³µ: ' + value + '</span>';
            } else {
                result.innerHTML = '<span class="error">âŒ ê°’ì´ ì—†ìŠµë‹ˆë‹¤</span>';
            }
        }

        function testStorageModule() {
            const result = document.getElementById('moduleResult');
            const apiKey = document.getElementById('testApiKey').value;
            
            if (!apiKey) {
                result.innerHTML = '<span class="error">âŒ API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”</span>';
                return;
            }

            try {
                const saved = Storage.Settings.saveGeminiApiKey(apiKey);
                result.innerHTML = '<span class="success">âœ… Storage ëª¨ë“ˆ ì €ì¥: ' + saved + '</span>';
            } catch (e) {
                result.innerHTML = '<span class="error">âŒ ì˜¤ë¥˜: ' + e.message + '</span>';
            }
        }

        function loadStorageModule() {
            const result = document.getElementById('moduleResult');
            try {
                const loaded = Storage.Settings.loadGeminiApiKey();
                if (loaded) {
                    result.innerHTML = '<span class="success">âœ… ë¡œë“œ ì„±ê³µ: ' + loaded.substring(0, 10) + '...</span>';
                } else {
                    result.innerHTML = '<span class="error">âŒ ì €ì¥ëœ ê°’ì´ ì—†ìŠµë‹ˆë‹¤</span>';
                }
            } catch (e) {
                result.innerHTML = '<span class="error">âŒ ì˜¤ë¥˜: ' + e.message + '</span>';
            }
        }

        function testFullSettings() {
            const result = document.getElementById('fullResult');
            try {
                Storage.Settings.saveGeminiApiKey('test_gemini_key_123');
                Storage.Settings.saveGithubRepoUrl('https://github.com/test/repo');
                Storage.Settings.saveTheme('dark');
                Storage.Settings.saveFontSize('medium');
                
                result.innerHTML = '<span class="success">âœ… ì „ì²´ ì„¤ì • ì €ì¥ ì™„ë£Œ</span>';
            } catch (e) {
                result.innerHTML = '<span class="error">âŒ ì˜¤ë¥˜: ' + e.message + '</span>';
            }
        }

        function loadFullSettings() {
            const result = document.getElementById('fullResult');
            try {
                const settings = Storage.Settings.loadAll();
                result.innerHTML = '<span class="success">âœ… ì „ì²´ ì„¤ì •:<br>' + 
                    'Gemini API: ' + (settings.geminiApiKey || 'ì—†ìŒ') + '<br>' +
                    'GitHub URL: ' + (settings.githubRepoUrl || 'ì—†ìŒ') + '<br>' +
                    'Theme: ' + (settings.theme || 'ì—†ìŒ') + '<br>' +
                    'Font Size: ' + (settings.fontSize || 'ì—†ìŒ') +
                    '</span>';
            } catch (e) {
                result.innerHTML = '<span class="error">âŒ ì˜¤ë¥˜: ' + e.message + '</span>';
            }
        }

        function clearAllSettings() {
            const result = document.getElementById('fullResult');
            try {
                localStorage.clear();
                result.innerHTML = '<span class="success">âœ… ì „ì²´ ì„¤ì • ì‚­ì œ ì™„ë£Œ</span>';
            } catch (e) {
                result.innerHTML = '<span class="error">âŒ ì˜¤ë¥˜: ' + e.message + '</span>';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í˜„ì¬ ì €ì¥ëœ ê°’ í‘œì‹œ
        window.onload = function() {
            console.log('ğŸ“¦ í˜„ì¬ LocalStorage:', localStorage);
            loadFullSettings();
        };
    </script>
</body>
</html>
